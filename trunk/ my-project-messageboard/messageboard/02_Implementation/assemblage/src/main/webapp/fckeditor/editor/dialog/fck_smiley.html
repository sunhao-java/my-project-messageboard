<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" >
<!--
 * FCKeditor - The text editor for Internet - http://www.fckeditor.net
 * Copyright (C) 2003-2009 Frederico Caldeira Knabben
 *
 * == BEGIN LICENSE ==
 *
 * Licensed under the terms of any of the following licenses at your
 * choice:
 *
 *  - GNU General Public License Version 2 or later (the "GPL")
 *    http://www.gnu.org/licenses/gpl.html
 *
 *  - GNU Lesser General Public License Version 2.1 or later (the "LGPL")
 *    http://www.gnu.org/licenses/lgpl.html
 *
 *  - Mozilla Public License Version 1.1 or later (the "MPL")
 *    http://www.mozilla.org/MPL/MPL-1.1.html
 *
 * == END LICENSE ==
 *
 * Smileys (emoticons) dialog window.
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="robots" content="noindex, nofollow"/>
    <style type="text/css">
        .Hand {
            cursor: pointer;
            cursor: hand;
        }
    </style>
    <script src="common/fck_dialog_common.js" type="text/javascript"></script>
    <script type="text/javascript">

        var dialog = window.parent ;
        var oEditor = dialog.InnerDialogLoaded() ;
		var FCKLang		= oEditor.FCKLang ;
        window.onload = function ()
        {
            // First of all, translate the dialog box texts
            oEditor.FCKLanguageManager.TranslatePage(document);

            dialog.SetAutoSize(true);
        }

        function InsertSmiley(url)
        {
            oEditor.FCKUndo.SaveUndoStep();

            var oImg = oEditor.FCK.InsertElement('img') ;
            oImg.src = url;
            oImg.setAttribute('_fcksavedurl', url);

            // For long smileys list, it seams that IE continues loading the images in
            // the background when you quickly select one image. so, let's clear
            // everything before closing.
            document.body.innerHTML = '';

            dialog.Cancel();
        }

        function over(td)
        {
            td.className = 'LightBackground Hand';
        }

        function out(td)
        {
            td.className = 'DarkBackground Hand';
        }
    </script>
    <script type="text/javascript">
    var FCKConfig = oEditor.FCKConfig ;
    var isMore = FCKConfig.MoreSmiley;
    var sMoreBasePath = FCKConfig.MoreSmileyPath ;
    var moreImages = FCKConfig.MoreSmileyImages;
    var sNames = FCKConfig.SmileyNames;
    function OnDialogTabChange(tabCode)
    {

        CreateTab(tabCode);
        for (var v = 0; v < sNames.length; v++) {
            if(GetE('table' + sNames[v].id)) {
            ShowE('table' + sNames[v].id, ( tabCode == sNames[v].id));
            }
        }
       // dialog.SetAutoSize(true);


    }
    function CreateTab(tabCode){
        var _tab = "table" + tabCode,showImages = GetE('ShowImages');
        var mImgs =moreImages[tabCode], aImages = mImgs.images,i = 0;

        if (aImages) {
            if (!GetE(_tab)) {
                var _div = document.createElement("DIV");
                _div.id = _tab;
                showImages.appendChild(_div);

                var t = '<table cellpadding="1" cellspacing="1" align="center" border="0"  width="100%" height="auto">';
                var ics = mImgs.columns,icWidth = parseInt(100 / ics, 10) ,imgHeight='';
                if(mImgs.imgHeight)  {
                     imgHeight='height:'+mImgs.imgHeight+'px';
                }

                while (i < aImages.length)
                {
                    t += '<tr>';
                    for (var j = 0; j < ics; j++)
                    {
                        if (aImages[i])
                        {
                            var sUrl = sMoreBasePath + tabCode + '/' + aImages[i] ;
                            t += '<td width="' + icWidth + '%" align="center" class="Hand" onclick="InsertSmiley(\'' + sUrl.replace(/'/g, "\\'") + '\')">';
                            t += '<img src="' + sUrl + '" border="0" style="'+imgHeight+'" />';
                        }
                        else
                            t += '<td width="' + icWidth + '%" >&nbsp;';
                        t += '</td>';
                        i++;
                    }
                    t += '</tr>';
                }
                t += '</table>';
                _div.innerHTML = t;

            }

        }

    }
    function init(){
        if (isMore) {
            CreateTab(sNames[0].id);
           // dialog.SetAutoSize(true);
        }
    }
</script>
</head>
<body style="overflow: hidden" onload="init()">

<div id="TabsRow" class="PopupTabArea" >
    <table width="100%" cellspacing="0" cellpadding="0" border="0">
        <tbody>
        <script type="text/javascript">
          if (isMore) {
          	var tn;
                for (var i = 0; i < sNames.length; i++) {
                	if(sNames[i].id == 'msn'){
                		tn = FCKLang.SmileyDefault;
                	}else if(sNames[i].id == 'msn'){
                		tn = FCKLang.SmileyDefault;
                	}else if(sNames[i].id == 'qq'){
                		tn = FCKLang.SmileyQQ;
                	}else if(sNames[i].id == 'ltj'){
                		tn = FCKLang.SmileyLTJ;
                	}else if(sNames[i].id == 'jp'){
                		tn = FCKLang.SmileyJP;
                	}else if(sNames[i].id == 'other'){
                		tn = FCKLang.SmileyOther;
                	}

                    dialog.AddTab(sNames[i].id, tn);
                }
        
            }
         
        </script>

        </tbody>
    </table>
</div>
<div id="ShowImages"></div>

	<table cellpadding="2" cellspacing="2" align="center" border="0" width="100%" height="100%">
        <script type="text/javascript">
            if (!isMore) {
                var sBasePath = FCKConfig.SmileyPath ;
                var aImages = FCKConfig.SmileyImages ;
                var iCols = FCKConfig.SmileyColumns ;
                var iColWidth = parseInt(100 / iCols, 10) ;

                var i = 0 ;
                while (i < aImages.length)
                {
                    document.write('<tr>');
                    for (var j = 0; j < iCols; j++)
                    {
                        if (aImages[i])
                        {
                            var sUrl = sBasePath + aImages[i] ;
                            document.write('<td width="' + iColWidth + '%" align="center" class="DarkBackground Hand" onclick="InsertSmiley(\'' + sUrl.replace(/'/g, "\\'") + '\')" onmouseover="over(this)" onmouseout="out(this)">');
                            document.write('<img src="' + sUrl + '" border="0" />');
                        }
                        else
                            document.write('<td width="' + iColWidth + '%" class="DarkBackground">&nbsp;');
                        document.write('<\/td>');
                        i++;
                    }
                    document.write('<\/tr>');
                }
            }
		</script>
	</table>
</body>
</html>
